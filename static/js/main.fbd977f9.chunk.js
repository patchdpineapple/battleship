(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],[,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(5),o=a.n(s),i=(a(10),a(3)),c=a(2),l=(a(11),a(12),a(0));var d=function(e){var t=e.onToggleStart;return Object(l.jsxs)("div",{className:"Start",children:[Object(l.jsx)("strong",{children:"BATTLESHIP"}),Object(l.jsx)("p",{children:"by Patchdpineapple"}),Object(l.jsx)("button",{className:"btn",onClick:t,children:"START GAME"})]})},u=(a(14),"valid");function h(e){var t=Object(n.useState)(!0),a=Object(c.a)(t,2),r=a[0],s=a[1],o=function(){s(!r)};return Object(l.jsx)(l.Fragment,{children:e.show?Object(l.jsx)("div",{id:e.id,type:e.type,length:e.length.length,className:"DragShip ".concat(r?"horizontal":"vertical"),onClick:o,draggable:!0,onDragStart:function(t){t.dataTransfer.setData("ship_type",e.type),t.dataTransfer.setData("ship_length",e.length.length),t.dataTransfer.setData("ship_axis",r?"horizontal":"vertical"),t.dataTransfer.effectAllowed="move"},onDragEnd:function(t){t.stopPropagation(),"invalid"!==u&&"move"===t.dataTransfer.dropEffect&&(r||o(),e.unshow())},children:e.length.map((function(e,t){return Object(l.jsx)("div",{className:"selectShip"},t)}))}):Object(l.jsx)("div",{})})}function p(e){return Object(l.jsxs)("div",{className:"ShipSelection",children:[Object(l.jsx)(h,{id:1,type:"Patrol",length:[1,2],show:e.showPatrol,unshow:e.handleUnshowPatrol}),Object(l.jsx)(h,{id:2,type:"Submarine",length:[1,2,3],show:e.showSubmarine,unshow:e.handleUnshowSubmarine}),Object(l.jsx)(h,{id:3,type:"Destroyer",length:[1,2,3],show:e.showDestroyer,unshow:e.handleUnshowDestroyer}),Object(l.jsx)(h,{id:4,type:"Battleship",length:[1,2,3,4],show:e.showBattleship,unshow:e.handleUnshowBattleship}),Object(l.jsx)(h,{id:5,type:"Carrier",length:[1,2,3,4,5],show:e.showCarrier,unshow:e.handleUnshowCarrier})]})}function b(e){e.index;var t=e.player,a=e.ship,n=e.coords,r=e.handlePlaceShip,s=function(e,a,n){var r,s=e,o=0,i=[],c=[],l=0,d=0,u=[],h=[],p=function(e){return"undefined"===typeof t.board.boardCoordinates[e]||!!t.board.boardCoordinates[e].ship};if("horizontal"===n){o=1;for(var b=11-a;b<10;b++)u.push(b);for(var f,j=0;j<u.length;j++){f=u[j];for(var x=0;x<10;x++)h.push(f),f+=10}}else if("vertical"===n){o=10;for(var v=110-10*a;v<100;v+=10)u.push(v);for(var m,O=0;O<u.length;O++){m=u[O];for(var y=0;y<10;y++)h.push(m),m+=1}}r=s,h.findIndex((function(e){return e===r}))>-1&&l++;for(var g=0;g<a;g++)i.push(s),p(s)&&d++,s+=o;if(l>0||d>0)return null;for(var k=0;k<i.length;k++)c.push({pos:t.board.boardCoordinates[i[k]].pos,isHit:!1});return c};return Object(l.jsx)("button",{className:"DropPanel ".concat(a?"dropped":"not_dropped"),onDrop:function(e){e.preventDefault(),e.target.classList.remove("draggingOver");var a=e.dataTransfer.getData("ship_type"),o=e.dataTransfer.getData("ship_length"),i=e.dataTransfer.getData("ship_axis"),c=t.board.boardCoordinates.findIndex((function(e){return e.pos.x===n.x&&e.pos.y===n.y})),l=s(c,o,i);l?(u="valid",r(a,o,l)):u="invalid"},onDragOver:function(e){e.preventDefault(),e.target.classList.add("draggingOver")},onDragLeave:function(e){e.preventDefault(),e.target.classList.remove("draggingOver")}})}function f(e){var t=e.player,a=e.handlePlaceShip;return Object(l.jsx)("div",{id:"DropBoard",className:"DropBoard",children:t.board.boardCoordinates.map((function(e,n){return Object(l.jsx)(b,{index:n,player:t,ship:e.ship,coords:e.pos,handlePlaceShip:a},n)}))})}var j=function(e){var t=e.player,a=e.handlePlaceShip,r=e.onResetShipPlacement,s=e.onDoneShipPlacement,o=Object(n.useState)(!0),i=Object(c.a)(o,2),d=i[0],u=i[1],h=Object(n.useState)(!0),b=Object(c.a)(h,2),j=b[0],x=b[1],v=Object(n.useState)(!0),m=Object(c.a)(v,2),O=m[0],y=m[1],g=Object(n.useState)(!0),k=Object(c.a)(g,2),S=k[0],w=k[1],P=Object(n.useState)(!0),C=Object(c.a)(P,2),N=C[0],A=C[1];return Object(l.jsxs)("div",{className:"ShipPlacement",children:[Object(l.jsxs)("div",{className:"ShipPlacement_container",children:[Object(l.jsx)(f,{player:t,handlePlaceShip:a}),Object(l.jsx)(p,{showPatrol:d,handleUnshowPatrol:function(){u(!1)},showSubmarine:j,handleUnshowSubmarine:function(){x(!1)},showDestroyer:O,handleUnshowDestroyer:function(){y(!1)},showBattleship:S,handleUnshowBattleship:function(){w(!1)},showCarrier:N,handleUnshowCarrier:function(){A(!1)}})]}),Object(l.jsx)("p",{children:"Drag and Drop to place a ship on the board. Click to change ship axis."}),Object(l.jsxs)("div",{children:[Object(l.jsx)("button",{className:"btn reset",onClick:function(){u(!0),x(!0),y(!0),w(!0),A(!0),r()},children:"Reset"}),Object(l.jsx)("button",{className:"btn done ".concat(5!==t.board.ships.length?"btn_disabled":""),onClick:s,disabled:5!==t.board.ships.length,children:"Done"})]})]})};a(15);function x(e){e.index;var t=e.turn,a=e.type,n=e.handlePlayerAttack,r=e.coords,s=e.ship,o=e.status,i=function(){n(r.x,r.y)};return s?Object(l.jsxs)(l.Fragment,{children:["sunk"===o?Object(l.jsx)("button",{className:"Panel sunk",children:Object(l.jsx)("i",{className:"far fa-times-circle"})}):null,"hit"===o?Object(l.jsx)("button",{className:"Panel hit ".concat("ship"),children:Object(l.jsx)("i",{className:"far fa-times-circle"})}):null,null===o?Object(l.jsx)("button",{className:"Panel ".concat("player"===a?"ship":""),onClick:function(){return"cpu"===a&&"player"===t?i():void 0}}):null]}):Object(l.jsxs)(l.Fragment,{children:["miss"===o?Object(l.jsx)("button",{className:"Panel miss",children:Object(l.jsx)("i",{className:"fas fa-circle fa-xs"})}):null,null===o?Object(l.jsx)("button",{className:"Panel",onClick:function(){return"cpu"===a&&"player"===t?i():void 0}}):null]})}function v(e){var t=e.onToggleRestart,a=e.handleRestartGame;return Object(l.jsx)("div",{className:"Restart",onClick:t,children:Object(l.jsxs)("div",{className:"Restart_container",children:[Object(l.jsx)("h2",{children:"Restart the game?"}),Object(l.jsx)("button",{className:"btn btn_restart",onClick:a,children:"Restart"}),Object(l.jsx)("button",{className:"btn btn_cancel",onClick:t,children:"Cancel"})]})})}var m=function(e){var t=e.player,a=e.CPU,r=e.turn,s=e.onToggleRestart,o=e.handlePlayerAttack,i=e.handleCPUAttack;return Object(n.useEffect)((function(){"cpu"===r&&i()}),[i,r]),Object(l.jsxs)("div",{className:"Game",children:[Object(l.jsx)("div",{className:"logo",children:Object(l.jsx)("button",{className:"btn_logo",onClick:s,children:"BATTLESHIP"})}),Object(l.jsxs)("div",{className:"board_container",children:[Object(l.jsxs)("div",{className:"player_container",children:[Object(l.jsx)("p",{style:{fontSize:"30px"},children:"Player"}),Object(l.jsx)("div",{className:"board player_board",children:t.board.boardCoordinates.map((function(e,t){return Object(l.jsx)(x,{index:t,type:"player",coords:e.pos,ship:e.ship,status:e.status},t)}))})]}),Object(l.jsx)("div",{className:"status_container",children:Object(l.jsx)("div",{className:"status_box",children:"player"===r?"Player turn":"CPU is attacking"})}),Object(l.jsxs)("div",{className:"cpu_container",children:[Object(l.jsx)("p",{style:{fontSize:"30px"},children:"CPU"}),Object(l.jsx)("div",{className:"board cpu_board",children:a.board.boardCoordinates.map((function(e,t){return Object(l.jsx)(x,{index:t,turn:r,type:"cpu",handlePlayerAttack:o,coords:e.pos,ship:e.ship,status:e.status},t)}))})]})]})]})};a(16);var O=function(e){var t=e.winner,a=e.handleRestartGame;return Object(l.jsx)("div",{className:"Result",children:Object(l.jsxs)("div",{className:"Result_container",children:[Object(l.jsx)("strong",{children:"player"===t?"Good job! You win!":"Game over. CPU wins."}),Object(l.jsx)("button",{className:"btn btn_playAgain",onClick:a,children:"Play again"})]})})},y=function(e){var t,a,n,r=[],s=function e(){var t={x:Math.floor(10*Math.random())+1,y:Math.floor(10*Math.random())+1};return h(t.x,t.y)>-1?e():t},o=!1,c="",l=null,d=!0,u=!0,h=function(e,t){return r.findIndex((function(a){return a.x===e&&a.y===t}))};return{board:e,randomAttack:s,playerAttack:function(e,t,a){return{coords:{x:e,y:t},result:a.board.receiveAttack(e,t)}},aiAttack:function(e){var t=s(),a=e.board.receiveAttack(t.x,t.y);return r.push(t),{coords:Object(i.a)({},t),result:a}},resetAttacksRecord:function(){for(var e=r.length,t=0;t<e;t++)r.pop()},aiAttackImproved:function(e){var p,b=function e(){var a;if(d?a=t.x+1:d||(a=t.x-1),a<11&&a>0&&-1===h(a,t.y))return{x:a,y:t.y};d=!d,t.x=n.x,e()},f=function e(){var a;if(u?a=t.y-1:u||(a=t.y+1),a<11&&a>0&&-1===h(t.x,a))return{x:t.x,y:a};u=!u,t.y=n.y,e()};if(o){if(o){var j;if(l){var x;if("horizontal"===l)do{x=b()}while("undefined"===typeof x);else if("vertical"===l)do{x=f()}while("undefined"===typeof x);if(p=e.board.receiveAttack(x.x,x.y),p,t=x,a=e.board.findBoardIndex(x.x,x.y),r.push(x),"sunk"===p)o=!1,c="",l=null;else if("hit"===p&&e.board.boardCoordinates[a].ship!==c||"miss"===p)switch(l){case"horizontal":d=!d,t.x=n.x;break;case"vertical":u=!u,t.y=n.y}}else if(j=function t(){var a,r,s=["left","right","up","down"][Math.floor(4*Math.random())];switch(s){case"left":r="horizontal",a={x:n.x-1,y:n.y};break;case"right":r="horizontal",a={x:n.x+1,y:n.y};break;case"up":r="vertical",a={x:n.x,y:n.y-1};break;case"down":r="vertical",a={x:n.x,y:n.y+1}}var o=e.board.findBoardIndex(a.x,a.y);return o>-1?h(a.x,a.y)>-1?t():{axis:r,direction:s,index:o,pos:a}:t()}(),p=e.board.receiveAttack(j.pos.x,j.pos.y),t=j.pos,a=j.index,p,r.push(j.pos),"sunk"===p&&e.board.boardCoordinates[j.index].ship===c)o=!1,c="",l=null;else if("hit"===p&&e.board.boardCoordinates[j.index].ship===c)switch(l=j.axis,j.direction){case"left":d=!1;break;case"right":d=!0;break;case"up":u=!0;break;case"down":u=!1}}}else{var v=s();p=e.board.receiveAttack(v.x,v.y),r.push(v),p,t=v,a=e.board.findBoardIndex(v.x,v.y),"sunk"===p&&(o=!1,c="",l=null),"hit"===p&&(o=!0,c=e.board.boardCoordinates[a].ship,n=v,a)}return{coords:Object(i.a)({},t),result:p}}}},g=function(e,t,a){return{type:e,length:t,coords:a,hit:function(e,t){a.map((function(a){return a.pos.x===e&&a.pos.y===t&&(a.isHit=!0),a}))},isSunk:function(){for(var e=0,n=0;n<a.length;n++)!0===a[n].isHit&&++e;return e===t}}},k=function(){var e=[],t=[],a=function(){if(0===e.length)for(var t=1;t<=10;t++)for(var a=1;a<=10;a++)e.push({pos:{x:a,y:t},ship:null,isAttacked:!1,status:null})},n=function(a,n,r){var s=g(a,n,r);return t.push(s),s.coords.map((function(t){var a=t.pos.x,n=t.pos.y,r=e.findIndex((function(e){return e.pos.x===a&&e.pos.y===n}));return e[r].ship=s.type,t})),"ship placed"},r=function(){t.map((function(t){t.isSunk()&&t.coords.map((function(t){var a=e.findIndex((function(e){return e.pos.x===t.pos.x&&e.pos.y===t.pos.y}));e[a].status="sunk"}))}))};return{ships:t,boardCoordinates:e,setBoardCoordinates:a,placeShip:n,receiveAttack:function(a,n){var s="";return e.forEach((function(e){e.pos.x===a&&e.pos.y===n&&(e.isAttacked=!0,null===e.ship?s=e.status="miss":(s=e.status="hit",t.forEach((function(t){t.type===e.ship&&(t.hit(a,n),t.isSunk()&&(s="sunk"))}))))})),r(),s},reportShips:function(){var e=0;return t.map((function(t){return!0===t.isSunk()&&e++,t})),e===t.length},updateToSunk:r,resetBoard:function(){for(var n=e.length,r=0;r<n;r++)e.pop();for(var s=t.length,o=0;o<s;o++)t.pop();a()},randomizeShip:function(){var t=function t(n){var r,s,o,i=[],c=[],l=0,d=0,u=!1,h=0===Math.floor(2*Math.random())?"horizontal":"vertical";if("horizontal"===h)l=1,o=x(r=[0,10,20,30,40,50,60,70,80,90][Math.floor(10*Math.random())],(s=r+(10-n))+1);else if("vertical"===h){l=10,o=x(r=[0,1,2,3,4,5,6,7,8,9][Math.floor(10*Math.random())],(s=r+10*n)+1);for(var p=[],b=r;b<=s;b+=10)p.push(b);o=p[Math.floor(Math.random()*p.length)]}for(var f=0;f<n;f++)i.push(o),a(o)&&d++,o+=l;!function(){if("horizontal"===h)for(var e=0;e<i.length;e++)0===e?(a(i[e]-10)||a(i[e]+10)||a(i[e]-1)||a(i[e]-11)||a(i[e]+9))&&(u=!0):e===i.length-1?(a(i[e]-10)||a(i[e]+10)||a(i[e]+1)||a(i[e]-9)||a(i[e]+11))&&(u=!0):(a(i[e]-10),a(i[e]+10));else if("vertical"===h)for(var t=0;t<i;t++)0===t?(a(i[t]-1)||a(i[t]+1)||a(i[t]-10)||a(i[t]-11)||a(i[t]-9))&&(u=!0):t===i.length-1?(a(i[t]-1)||a(i[t]+1)||a(i[t]+10)||a(i[t]+9)||a(i[t]+11))&&(u=!0):(a(i[t]-1),a(i[t]+1))}();for(var j=0;j<i.length;j++)c.push({pos:e[i[j]].pos,isHit:!1});function x(e,t){return Math.floor(Math.random()*(t-e))+e}return 0===d&&!1===u?c:t(n)},a=function(t){return"undefined"!==typeof e[t]&&!!e[t].ship};!function(){var e;e=t(5),n("Carrier",5,e),e=t(4),n("Battleship",4,e),e=t(3),n("Submarine",3,e),e=t(3),n("Destroyer",3,e),e=t(2),n("Patrol",2,e)}()},findBoardIndex:function(t,a){return e.findIndex((function(e){return e.pos.x===t&&e.pos.y===a}))}}},S=function(){var e="player",t=y(k()),a=y(k());return{Player:t,CPU:a,turn:e,start:function(){t.board.setBoardCoordinates(),a.board.setBoardCoordinates()},resetGame:function(){t.board.resetBoard(),a.board.resetBoard(),a.resetAttacksRecord(),e="player"},randomizeShips:function(){a.board.randomizeShip()}}}(),w=a.p+"static/media/splash2.19ae4f12.flac",P=a.p+"static/media/cannonshot 8bit.bc64263f.wav",C=a.p+"static/media/explode 8bit.9143f8a8.wav",N=a.p+"static/media/win.3a1474da.wav",A=a.p+"static/media/lose.af07075d.wav",D=a.p+"static/media/start game.35972233.ogg";var T=function(){var e=Object(n.useState)(S.turn),t=Object(c.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)(S.Player),o=Object(c.a)(s,2),u=o[0],h=o[1],p=Object(n.useState)(S.CPU),b=Object(c.a)(p,2),f=b[0],x=b[1],y=Object(n.useState)(!0),g=Object(c.a)(y,2),k=g[0],T=g[1],B=Object(n.useState)(!1),_=Object(c.a)(B,2),R=_[0],U=_[1],M=Object(n.useState)(!1),z=Object(c.a)(M,2),I=z[0],E=z[1],G=Object(n.useState)(!1),H=Object(c.a)(G,2),L=H[0],F=H[1],J=Object(n.useState)(!1),Y=Object(c.a)(J,2),q=Y[0],K=Y[1],Q=Object(n.useState)("none"),V=Object(c.a)(Q,2),W=V[0],X=V[1],Z=function(){F(!L)},$=function(){r("cpu"===a?"player":"cpu")},ee=function(){K(!q)},te=function(){S.resetGame(),T(!k),E(!I),L&&F(!L),q&&K(!q)},ae=function(e){var t=document.createElement("audio");switch(e){case"miss":t.src=w,t.volume=.2;break;case"hit":t.src=P;break;case"sunk":t.src=C;break;case"win":t.src=N;break;case"lose":t.src=A;break;case"start":t.src=D}t&&(t.currentTime=0,t.play())};return Object(l.jsxs)("div",{className:"App",children:[q&&Object(l.jsx)(O,{winner:W,handleRestartGame:te}),R&&Object(l.jsx)(j,{player:u,handlePlaceShip:function(e,t,a){var n=u;n.board.placeShip(e,parseInt(t),a),h(Object(i.a)({},n))},onResetShipPlacement:function(){var e=u;e.board.resetBoard(),h(Object(i.a)({},e))},onDoneShipPlacement:function(){U(!R),E(!I),S.randomizeShips()}}),k&&Object(l.jsx)(d,{onToggleStart:function(){U(!R),T(!k),S.start(),ae("start")}}),L&&Object(l.jsx)(v,{onToggleRestart:Z,handleRestartGame:te}),I&&Object(l.jsx)(m,{player:u,CPU:f,turn:a,onToggleRestart:Z,handlePlayerAttack:function(e,t){var a=f,n=u.playerAttack(e,t,a);if(x(Object(i.a)({},a)),"miss"===n.result&&$(),a.board.reportShips())return X("player"),ae("win"),ee();ae(n.result)},handleCPUAttack:function(){var e=u,t=f.aiAttackImproved(e);setTimeout((function(){if("miss"===t.result&&$(),h(Object(i.a)({},e)),e.board.reportShips())return $(),X("cpu"),ae("lose"),ee();ae(t.result)}),1500)}})]})};o.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(T,{})}),document.getElementById("root"))}],[[17,1,2]]]);
//# sourceMappingURL=main.fbd977f9.chunk.js.map